{% extends 'base.html' %}
{% block content %}
<h4 class="center-align">URL Groups</h4>
<div class="row">
  <div class="col s12 center-align" style="margin-bottom: 2rem;">
    <a class="btn blue modal-trigger" href="#new-url-group-modal"><i class="material-icons left">add_circle</i>New URL Group</a>
  </div>
</div>
<div class="row">
  {% for group in groups %}
    <div class="col s12 m6 l4">
      <div class="card">
        <div class="card-content">
          <span class="card-title">{{ group.name }}</span>
          <ul class="collection">
            {% for url in urls_in_group[group.group_id] %}
              <li class="collection-item">
                {{ url }}
                <form method="post" action="/url-groups/{{ group.group_id }}/remove-url" style="display:inline; float:right;">
                  <input type="hidden" name="path" value="{{ url }}">
                  <button class="btn-flat btn-small red-text" type="submit" title="Remove URL">
                    <i class="material-icons">remove_circle</i>
                  </button>
                </form>
              </li>
            {% endfor %}
          </ul>
        </div>
        <div class="card-action">
          <a class="btn green modal-trigger" href="#add-url-modal-{{ group.group_id }}">
            <i class="material-icons left">add</i>Add URL
          </a>
          {% if group.group_id not in associated_url_group_ids %}
          <form method="post" action="/url-groups/{{ group.group_id }}/delete" style="display:inline;">
            <button class="btn-flat btn-small red-text" type="submit" title="Delete Group">
              <i class="material-icons left">delete</i>Delete
            </button>
          </form>
          {% endif %}
        </div>
      </div>
    </div>
    <!-- Add URL Modal -->
    <div id="add-url-modal-{{ group.group_id }}" class="modal">
      <div class="modal-content">
        <h5>Add URL to {{ group.name }}</h5>
        <form method="post" action="/url-groups/{{ group.group_id }}/add-url">
          <div class="input-field">
            <input type="text" name="path" id="add-url-path-{{ group.group_id }}" required>
            <label for="add-url-path-{{ group.group_id }}">URL Path</label>
          </div>
          <button class="btn green" type="submit">Add</button>
        </form>
      </div>
    </div>
  {% endfor %}
</div>
<!-- New URL Group Modal -->
<div id="new-url-group-modal" class="modal">
  <div class="modal-content">
    <h5>Create New URL Group</h5>
    <form method="post" action="/url-groups">
      <div class="input-field">
        <input type="text" name="name" id="new-url-group-name" required>
        <label for="new-url-group-name">Group Name</label>
      </div>
      <button class="btn blue" type="submit">Create</button>
    </form>
  </div>
</div>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    var elems = document.querySelectorAll('.modal');
    M.Modal.init(elems);
  });
</script>
{% endblock %} 