{% extends 'base.html' %}
{% block content %}
<h4 class="center-align">Associations</h4>
<div class="row">
  <div class="col s12 center-align" style="margin-bottom: 2rem;">
    <a class="btn green modal-trigger" href="#new-association-modal">
      <i class="material-icons left">add</i>New Association
    </a>
  </div>
</div>
<div class="row">
  {% for assoc in associations %}
    <div class="col s12 m6 l4">
      <div class="card">
        <div class="card-content">
          <span class="card-title">
            <i class="material-icons left">group</i>User Group: {{ assoc.user_group_name }}
          </span>
          <p>
            <i class="material-icons left">link</i>
            <b>URL Group:</b> {{ assoc.url_group_name }}
          </p>
        </div>
        <div class="card-action right-align">
          <form method="post" action="/associations/remove" style="display:inline;">
            <input type="hidden" name="user_group_id" value="{{ assoc.user_group_id }}">
            <input type="hidden" name="url_group_id" value="{{ assoc.url_group_id }}">
            <button class="btn-flat btn-small red-text" type="submit" title="Remove Association">
              <i class="material-icons left">delete</i>Remove
            </button>
          </form>
        </div>
      </div>
    </div>
  {% endfor %}
</div>
<!-- New Association Modal -->
<div id="new-association-modal" class="modal">
  <div class="modal-content">
    <h5>Create New Association</h5>
    <form method="post" action="/associations">
      <div class="input-field">
        <select name="user_group_id" required>
          <option value="" disabled selected>Choose User Group</option>
          {% for group in user_groups %}
            <option value="{{ group.group_id }}">{{ group.name }}</option>
          {% endfor %}
        </select>
        <label>User Group</label>
      </div>
      <div class="input-field">
        <select name="url_group_id" required>
          <option value="" disabled selected>Choose URL Group</option>
          {% for group in url_groups %}
            <option value="{{ group.group_id }}">{{ group.name }}</option>
          {% endfor %}
        </select>
        <label>URL Group</label>
      </div>
      <button class="btn green" type="submit">Create</button>
    </form>
  </div>
</div>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    var modals = document.querySelectorAll('.modal');
    M.Modal.init(modals);
    var selects = document.querySelectorAll('select');
    M.FormSelect.init(selects);
  });
</script>
{% endblock %} 